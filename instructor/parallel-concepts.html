<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>HPC User: Parallel Computing Concepts</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../parallel-concepts.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      HPC User
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            HPC User
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  HPC User
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 19%" class="percentage">
    19%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 19%" aria-valuenow="19" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../parallel-concepts.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Introduction</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="profiling-code.html">2. Profiling Code for Performance</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="performance-concepts.html">3. Performance Concepts</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        4. Parallel Computing Concepts
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#optimizing-scalar-code">Optimizing Scalar Code</a></li>
<li><a href="#parallelizing-code">Parallelizing Code</a></li>
<li><a href="#parallel-computing-concepts">Parallel Computing Concepts</a></li>
<li><a href="#using-accelerators-like-gpus">Using Accelerators like GPUs</a></li>
<li><a href="#optimizing-input-and-output">Optimizing Input and Output</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="multi-threaded.html">5. Multi-Threaded Programs</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="message-passing.html">6. Message-Passing Programs</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="language-survey.html">7. Language Survey</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="c-cpp.html">8. C and C++ Languages</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="fortran.html">9. The Fortran Language</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="python.html">10. The Python Language</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="r.html">11. The R Language</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="matlab.html">12. The Matlab Language</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="array-jobs.html">13. Array Jobs</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="gpus.html">14. Accelerating Scientific Computing with GPUs</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="high-throughput-computing.html">15. High-Throughput Computing</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush17">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading17">
        <a href="hpc-resources.html">16. HPC Resources</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/performance-concepts.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/multi-threaded.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/performance-concepts.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Performance Concepts
        </a>
        <a class="chapter-link float-end" href="../instructor/multi-threaded.html" rel="next">
          Next: Multi-Threaded...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Parallel Computing Concepts</h1>
        <p>Last updated on 2024-08-21 |

        <a href="https://github.com/DrDaveTurner/HPC-User/edit/main/episodes/parallel-concepts.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>Now that we can profile programs to find where the time is being
spent, how do we speed the code up?</li>
<li>What is parallel computing, and what are the underlying concepts
that make it work?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Learn different approaches to speeding up code.</li>
</ul></div>
</div>
</div>
</div>
</div>
<p>In the last chapter we learned how to profile a program to understand
where the time is being spent. In this section, we will talk more about
how to improve the performance of different parts of a program. This may
involve steering clear of inefficient methods in some computer
languages, minimizing the operation count, using optimized libraries,
and applying multiple cores or even multiple compute nodes to speed up
each computational part. Computations can sometimes be sped up
enormously using accelerators like GPUs (Graphic Processing Units) as
well. Reducing or eliminating IO can sometimes help, but ensuring that
the IO is done without costly locks, and to a file server that is not
overly used, can often help performance greatly as well.</p>
<section><h2 class="section-heading" id="optimizing-scalar-code">Optimizing Scalar Code<a class="anchor" aria-label="anchor" href="#optimizing-scalar-code"></a>
<a class="anchor" aria-label="anchor" href="#optimizing-scalar-code"></a></h2>
<hr class="half-width"><p>Programming in languages like C/C++ and Fortran produces fairly
efficient code in general because these are compiled languages. In other
words, you need to compile the code before executing it, and the
compilers do very intricate optimizations to ensure the resulting
executable is highly efficient. Interpretive languages like Python, R,
and Matlab only do some compilation on the fly. They are therefore much
less optimized, but more convenient to run. We have already learned the
importance of using optimized library routines whenever possible, but
this is especially true for the interpretive languages. Some languages
also have certain methods that are convenient, but very inefficient, and
what to avoid and how to get around them will be discussed in later
chapters.</p>
<p>One thing that can help in understanding performance is to know how
much it costs to perform different common math functions. We can express
the speed of a code in GFlops, or Giga (Billion) Floating-point
operations per second. A floating-point operation involves two operands
that are typically 64-bit floats. When counting the Flops, we ignore
integer arithmetic and comparisons since those are very fast in relation
to the floating-point operations. Below is a table of the Flop cost for
each operation. This can be thought of as for example how many
operations does it take to do a cosine function, since the cosine is
done using a math library.</p>
<table class="table"><thead><tr class="header"><th align="center">Function / Operation</th>
<th align="center">Flops count</th>
</tr></thead><tbody><tr class="odd"><td align="center">* + -</td>
<td align="center">1</td>
</tr><tr class="even"><td align="center">/</td>
<td align="center">4</td>
</tr><tr class="odd"><td align="center">square root</td>
<td align="center">4</td>
</tr><tr class="even"><td align="center">sin()/cos()/tan()</td>
<td align="center">6</td>
</tr><tr class="odd"><td align="center">exponent()</td>
<td align="center">14</td>
</tr></tbody></table><p>One example of how this knowledge can help is if you have a large
loop where you are dividing by 4.0. Instead, you reduce the operation
count by 3 if you multiply by 0.25. This is not needed in compiled
languages like C/C++ or Fortran since the compiler does this
optimization for you, but it can help in the interpretive languages. The
example below reduces the floating-point operation count by removing the
redundant calculation of theta and replacing the expensive calculations
of the cosine and sine by using an iterative method using trigonometric
identities.</p>
<div class="tabs">
<nav><div id="nav-tab-1" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-1-Python" name="Python" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Python" type="button" role="tab" aria-controls="nav-tabpanel-1-Python" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-1-Python">
  Python
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-R" name="R" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-R" type="button" role="tab" aria-controls="nav-tabpanel-1-R" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-R">
  R
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-C" name="C" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-C" type="button" role="tab" aria-controls="nav-tabpanel-1-C" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-C">
  C
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-Fortran" name="Fortran" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Fortran" type="button" role="tab" aria-controls="nav-tabpanel-1-Fortran" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-Fortran">
  Fortran
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-Matlab" name="Matlab" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Matlab" type="button" role="tab" aria-controls="nav-tabpanel-1-Matlab" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-Matlab">
  Matlab
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-1" class="tab-content">
<div id="nav-tabpanel-1-Python" class="tab-pane show active" aria-labelledby="nav-tab-1-Python" role="tabpanel">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># This is just partial code to demonstrate the mechanics of</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#    using Flops minimization to optimize code for performance</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="co"># Define the number of frequencies and zero the array before summation</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>freq_real <span class="op">=</span> [ <span class="fl">0.0</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>( NQ ) ]</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>freq_imag <span class="op">=</span> [ <span class="fl">0.0</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>( NQ ) ]</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="co"># Sum over each atom in the simulation</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>( N_atoms ):</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>    dx <span class="op">=</span> x[i] <span class="op">-</span> y[i]</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>        <span class="co"># Sum over the frequencies</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    <span class="cf">for</span> iq <span class="kw">in</span> <span class="bu">range</span>( NQ ):</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>        theta <span class="op">=</span> <span class="fl">2.0</span> <span class="op">*</span> PI <span class="op">*</span> dx <span class="op">*</span> iq <span class="op">/</span> NQ</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>        freq_real[iq] <span class="op">+=</span> cos( theta )</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>        freq_imag[iq] <span class="op">+=</span> sin( theta )</span></code></pre>
</div>
</div>
<div id="nav-tabpanel-1-R" class="tab-pane" aria-labelledby="nav-tab-1-R" role="tabpanel">
<p>Not implemented yet.</p>
</div>
<div id="nav-tabpanel-1-C" class="tab-pane" aria-labelledby="nav-tab-1-C" role="tabpanel">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">C<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode c" tabindex="0"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">// This is just partial code to demonstrate the mechanics of</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">//    using Flops minimization to optimize code for performance</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>      <span class="co">// Sum over each atom in the simulation and all frequencies</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>   <span class="cf">for</span><span class="op">(</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N_atoms<span class="op">;</span> i<span class="op">++</span> <span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>      dx <span class="op">=</span> x<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> y<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>      <span class="cf">for</span><span class="op">(</span> iq <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> iq <span class="op">&lt;</span> NQ<span class="op">;</span> iq<span class="op">++</span> <span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>            <span class="co">// Sum over the frequencies</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>         theta <span class="op">=</span> <span class="op">(</span><span class="fl">2.0</span> <span class="op">*</span> PI <span class="op">*</span> dx <span class="op">*</span> iq<span class="op">)</span> <span class="op">/</span> NQ<span class="op">;</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>         freq_real<span class="op">[</span>iq<span class="op">]</span> <span class="op">+=</span> cos<span class="op">(</span> theta <span class="op">);</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>         freq_imag<span class="op">[</span>iq<span class="op">]</span> <span class="op">+=</span> sin<span class="op">(</span> theta <span class="op">);</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>   <span class="op">}</span></span></code></pre>
</div>
</div>
<div id="nav-tabpanel-1-Fortran" class="tab-pane" aria-labelledby="nav-tab-1-Fortran" role="tabpanel">
<p>Not implemented yet.</p>
</div>
<div id="nav-tabpanel-1-Matlab" class="tab-pane" aria-labelledby="nav-tab-1-Matlab" role="tabpanel">
<p>Not implemented yet.</p>
</div>
</div>
</div>
<div class="tabs">
<nav><div id="nav-tab-2" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-2-Python" name="Python" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-Python" type="button" role="tab" aria-controls="nav-tabpanel-2-Python" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-2-Python">
  Python
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-R" name="R" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-R" type="button" role="tab" aria-controls="nav-tabpanel-2-R" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-R">
  R
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-C" name="C" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-C" type="button" role="tab" aria-controls="nav-tabpanel-2-C" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-C">
  C
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-Fortran" name="Fortran" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-Fortran" type="button" role="tab" aria-controls="nav-tabpanel-2-Fortran" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-Fortran">
  Fortran
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-Matlab" name="Matlab" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-Matlab" type="button" role="tab" aria-controls="nav-tabpanel-2-Matlab" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-Matlab">
  Matlab
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-2" class="tab-content">
<div id="nav-tabpanel-2-Python" class="tab-pane show active" aria-labelledby="nav-tab-2-Python" role="tabpanel">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># This is just partial code to demonstrate the mechanics of</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#    using Flops minimization to optimize code for performance</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="co"># Define the number of frequencies and zero the array before summation</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>freq_real <span class="op">=</span> [ <span class="fl">0.0</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>( NQ ) ]</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>freq_imag <span class="op">=</span> [ <span class="fl">0.0</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>( NQ ) ]</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>d_theta <span class="op">=</span> ( <span class="fl">2.0</span> <span class="op">*</span> PI <span class="op">*</span> (x[<span class="dv">0</span>] <span class="op">-</span> y[<span class="dv">0</span>]) ) <span class="op">/</span> NQ</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    <span class="co"># Sum over each atom in the simulation</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>( N_atoms ):</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    dx <span class="op">=</span> x[i] <span class="op">-</span> y[i]</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>        <span class="co"># Calculate cos/sin of the theta increment and set starting cos/sin values</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>    cos_d_theta <span class="op">=</span> cos( d_theta )</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>    sin_d_theta <span class="op">=</span> sin( d_theta )</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>    cos_theta <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>    sin_theta <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>        <span class="co"># Sum over the frequencies</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>    <span class="cf">for</span> iq <span class="kw">in</span> <span class="bu">range</span>( NQ ):</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>        cos_new <span class="op">=</span> cos_theta <span class="op">*</span> cos_d_theta <span class="op">-</span> sin_theta <span class="op">*</span> sin_d_theta</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>        sin_theta <span class="op">=</span> sin_theta <span class="op">*</span> cos_d_theta <span class="op">+</span> cos_theta <span class="op">*</span> cos_d_theta</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>        cos_theta <span class="op">=</span> cos_new</span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>        freq_real[iq] <span class="op">+=</span> cos_theta</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>        freq_imag[iq] <span class="op">+=</span> sin_theta</span></code></pre>
</div>
</div>
<div id="nav-tabpanel-2-R" class="tab-pane" aria-labelledby="nav-tab-2-R" role="tabpanel">
<p>Not implemented yet.</p>
</div>
<div id="nav-tabpanel-2-C" class="tab-pane" aria-labelledby="nav-tab-2-C" role="tabpanel">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">C<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode c" tabindex="0"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">// This is just partial code to demonstrate the mechanics of</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">//    using Flops minimization to optimize code for performance</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>   d_theta <span class="op">=</span> <span class="op">(</span> <span class="fl">2.0</span> <span class="op">*</span> PI <span class="op">*</span> <span class="op">(</span>x<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">-</span> y<span class="op">[</span><span class="dv">0</span><span class="op">])</span> <span class="op">)</span> <span class="op">/</span> NQ<span class="op">;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>      <span class="co">// Sum over each atom in the simulation and all frequencies</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>   <span class="cf">for</span><span class="op">(</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N_atoms<span class="op">;</span> i<span class="op">++</span> <span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>      dx <span class="op">=</span> x<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> y<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>         <span class="co">// Calculate cos/sin of the theta increment and set starting cos/sin values</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>      cos_d_theta <span class="op">=</span> cos<span class="op">(</span> d_theta <span class="op">);</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>      sin_d_theta <span class="op">=</span> sin<span class="op">(</span> d_theta <span class="op">);</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>      cos_theta <span class="op">=</span> <span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>      sin_theta <span class="op">=</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>      <span class="cf">for</span><span class="op">(</span> iq <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> iq <span class="op">&lt;</span> NQ<span class="op">;</span> iq<span class="op">++</span> <span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>         cos_new <span class="op">=</span> cos_theta <span class="op">*</span> cos_d_theta <span class="op">-</span> sin_theta <span class="op">*</span> sin_d_theta<span class="op">;</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>         sin_theta <span class="op">=</span> sin_theta <span class="op">*</span> cos_d_theta <span class="op">+</span> cos_theta <span class="op">*</span> cos_d_theta<span class="op">;</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>         cos_theta <span class="op">=</span> cos_new<span class="op">;</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>            <span class="co">// Sum over the frequencies</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>         freq_real<span class="op">[</span>iq<span class="op">]</span> <span class="op">+=</span> cos_theta<span class="op">;</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>         freq_imag<span class="op">[</span>iq<span class="op">]</span> <span class="op">+=</span> sin_theta<span class="op">;</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>   <span class="op">}</span></span></code></pre>
</div>
</div>
<div id="nav-tabpanel-2-Fortran" class="tab-pane" aria-labelledby="nav-tab-2-Fortran" role="tabpanel">
<p>Not implemented yet.</p>
</div>
<div id="nav-tabpanel-2-Matlab" class="tab-pane" aria-labelledby="nav-tab-2-Matlab" role="tabpanel">
<p>Not implemented yet.</p>
</div>
</div>
</div>
<p>This is however a very over-simplified picture since it involves just
analyzing one factor. In practice, most processors can overlap
calculations for better speed like in the AVX vector instruction sets of
the Intel and AMD x86 architectures.</p>
<div id="flops-count" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="flops-count" class="callout-inner">
<h3 class="callout-title">Flops count<a class="anchor" aria-label="anchor" href="#flops-count"></a>
</h3>
<div class="callout-content">
<p>Count the floating-point operations (Flops) in the unoptimized and
optimized versions of the code above and calculate the expected speedup
rate.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The unoptimized code uses <strong>N_atoms * ( 1 + 21 * NQ )
Flops</strong>. The optimized version uses <strong>N_atoms * ( 13 + 6 *
NQ ) Flops</strong>. For large NQ the speedup would be around 21/6 or
<strong>3.5 times</strong>.</p>
<p>The compiled languages C/C++/Fortran would optimize some of this loop
automatically by pulling the <strong>2.0 * PI * dx / NQ</strong> out of
the <strong>NQ</strong> loop and just multiplying this by
<strong>iq</strong> each time.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="parallelizing-code">Parallelizing Code<a class="anchor" aria-label="anchor" href="#parallelizing-code"></a>
<a class="anchor" aria-label="anchor" href="#parallelizing-code"></a></h2>
<hr class="half-width"><p>It is always good to optimize a scalar code first, but if you still
need your code to run faster then one option is to use more processing
power. This means using more then one computational core with each core
working on a different part of the data. The goal is to get a speedup of
N times if you are using N cores, though often parallel programs will
fall short of this ideal.</p>
<p>There are two main types of parallel programming. The first is
multi-core or shared-memory programming. This is the easiest approach,
with a single program running but for computationally demanding sections
like loops multiple threads are used with typically one thread on each
computational core. In this way, the scalar part of the code does not
need to be altered and we only need to put parallelizing commands before
each loop to tell the computer how to divide the problem up. It is
called <strong>shared-memory</strong> because all threads operate on the
data that is shared in main memory. This is the easiest approach, is
often very efficient, but has the limitation that it needs to work only
on a single compute node. Multi-threading in C/C++ and Fortran use the
<strong>OpenMP</strong> package, Python uses a simplified version of
this called <strong>pymp</strong>, and R allows for this through the
<strong>mclapply()</strong> function.</p>
<p>If you need even more computational power, or need access to more
memory than is on a single node, then you need to use multi-node
computing. This is also referred to as distributed-memory computing
since each thread in this case is its own separate but identical
program, again just operating on a different part of the data.
Distributed-memory programs can be run on a single compute node when
needed, but are designed to run on very large numbers of nodes at the
same time. Some programs have been run on millions of compute nodes, or
some of the largest HPC systems in the world which may cost more than
$100 million. C/C++ and Fortran codes use MPI, the Message-Passing
Interface, launching all the copies of the program to the different
nodes using the <strong>mpirun</strong> command, then each node shakes
hands with the others with the <strong>MPI_Init()</strong> function.
Each thread or task will operate on a different part of the data, and
when data needs to be exchanged the programmer can use MPI commands like
<strong>MPI_Send()</strong> and <strong>MPI_Recv()</strong> to pass
blocks of data to other threads. This is a very powerful way to program,
but it is definitely much more complicated too. Python has the
<strong>mpi4py</strong> package which is a stripped down version of MPI,
but unfortunately you cannot do multi-node computing with R.</p>
<p>You will not be taught how to program in these parallel languages in
this course, but you will be shown how to recognize each type of
parallel approach and how to work with each efficiently.</p>
</section><section><h2 class="section-heading" id="parallel-computing-concepts">Parallel Computing Concepts<a class="anchor" aria-label="anchor" href="#parallel-computing-concepts"></a>
<a class="anchor" aria-label="anchor" href="#parallel-computing-concepts"></a></h2>
<hr class="half-width"><p>The syntax for doing parallel processing is different for
multi-threaded and multi-node programming, and also can vary for each
language, but handling multiple threads at the same time always involves
some of the same basic underlying concepts. Understanding the basic
concepts underlying these methods will help us to understand the
functions at the language level themselves.</p>
<div class="section level3">
<h3 id="locks-in-programs-and-file-systems">Locks in Programs and File Systems<a class="anchor" aria-label="anchor" href="#locks-in-programs-and-file-systems"></a></h3>
<p>A multi-threaded program uses shared-memory where many threads may
want to access the same data at the same time. If they are all reading
the data, this is not a problem. However, if even one thread wants to
change the data by writing to it while other threads may be reading it,
this can lead to uncertain results depending on which thread does its
read or write first. This uncertainty must therefore always be avoided,
and often it is handled by locking memory when a write occurs so that
only that one thread has access at that time.</p>
<p>The same thing can happen in parallel file servers where there are
multiple paths being exploited to the same data file in order to provide
better performance. If multiple threads, or even multiple programs, are
reading the same file or different files in the same directory then
everything is fine. However, if one of those is writing to a file then a
parallel file server will lock the entire directory down to prevent
other threads from reading until the write is completed. This is
something that every user needs to be aware of. It only applies to
parallel file servers, so local disk (/tmp) has no problems with this
since there is only one controller for the disk, while a parallel file
server has many controlling nodes. Some scratch space also can handle
multiple writes to the same directory without locking. Since this can
have severe impacts on performance, it is always good to ask your system
administrator if you don’t know. Ways around this include switching to a
different file system like /tmp while running the job, or putting the
files in different directories.</p>
</div>
<div class="section level3">
<h3 id="barriers">Barriers<a class="anchor" aria-label="anchor" href="#barriers"></a></h3>
<p>Since distributed-memory programs involve multiple copies of the same
code, we commonly need to ensure that all are at the same point in the
code. MPI uses barriers for this, an <strong>MPI_Barrier()</strong>
function to be exact. When this is encountered, each task will stop and
wait until all tasks reach that point in the code, they will communicate
this to each other, then continue on. A common example of why you would
need this would be in debugging an MPI code where you want to identify
where the code may be failing. If one task gets ahead of the other and
errors out, it may be that the root task will be at a different place in
the code and report that line where the job failed.</p>
</div>
<div class="section level3">
<h3 id="forks">Forks<a class="anchor" aria-label="anchor" href="#forks"></a></h3>
<p>All multi-threaded packages use some sort of a fork function. When a
loop is encountered and the root thread needs to spin up multiple
threads to do the work, it does so by doing a <strong>fork()</strong>
which duplicates the variables in the root thread. This is done
virtually which may be a bit confusing. If every piece of data was
copied it would increase the memory usage enormously for runs on large
numbers of cores, so only the pointers to the arrays are copied. If the
data is only being read then all threads can read from the original
array. If any thread writes to part of an array, then a unique copy of
that part of the array is made for that thread only. So the fork process
manages the memory usage behind the scenes to minimize the redundant
storage of data, but ensures that there is no need for a memory lock
when a thread writes to that data by making a copy instead.</p>
</div>
<div class="section level3">
<h3 id="dependencies-in-loops">Dependencies in Loops<a class="anchor" aria-label="anchor" href="#dependencies-in-loops"></a></h3>
<p>All those mechanisms discussed above may be used in implementing a
parallel computing package. As a user, what we really need to know is
when can a section of a program be parallelized. If you look at the
loops where the most computational time is being spent, what you need to
determine is whether each pass through the loop is independent of the
others, or whether each pass is dependent on the results of the previous
iteration. If each pass through a loop can be done independently of the
others, then we can do them at the same time. This is a simple
statement, but it does sometimes take more thinking to understand if
there are any dependencies involved. If you have any doubt, try writing
down all the variables that are needed as input for each iteration of
the loop, then see if any of those change throughout the loop.</p>
<p>If you have a program with nested loops, you may need to analyze each
loop level to see if it is parallelizable. Parallelizing the outer loop
means that there will be more computations for each thread or task,
which is referred to as being more coarse grained. This can lead to much
higher efficiencies, but it is not always possible. Often it is the
inner loop that is easiest to parallelize, and this is most often the
case with multi-threaded parallelism.</p>
</div>
</section><section><h2 class="section-heading" id="using-accelerators-like-gpus">Using Accelerators like GPUs<a class="anchor" aria-label="anchor" href="#using-accelerators-like-gpus"></a>
<a class="anchor" aria-label="anchor" href="#using-accelerators-like-gpus"></a></h2>
<hr class="half-width"><p>Some programs can be sped up by using a GPU as a computational
accelerator. A 32-bit GPU is the same as you would buy for a high-end
gaming computer and can cost $1000-$1500. These are ideal for
accelerating 32-bit codes like classical molecular dynamics simulations,
and have custom hardware that is great for training AI (Artificial
Intelligence) neural networks or machine learning models. The more
expensive 64-bit GPUs are never intended for graphics at all. They are
custom designed as accelerators even though they are still called GPUs.
These currently cost around $11,000 for an NVIDIA A100 and around twice
that for a newer H100.</p>
<p>Writing a program to run on a GPU is very difficult. For NVIDIA GPUs,
you use a programming language called CUDA. There are many fewer codes
optimized for AMD GPUs at this point. They are programmed with Hip which
can be compiled to run on either AMD or NVIDIA GPUs. There are also
projects in development to convert native CUDA codes into executables
optimized for AMD GPUs.</p>
<p>Running a job with a GPU accelerator is not that difficult. If your
application can make use of one or more GPUs, there will be directions
on how to specify the number of GPUs. If you are on an HPC system, you
can request the number and type of GPUs you want for each job.</p>
</section><section><h2 class="section-heading" id="optimizing-input-and-output">Optimizing Input and Output<a class="anchor" aria-label="anchor" href="#optimizing-input-and-output"></a>
<a class="anchor" aria-label="anchor" href="#optimizing-input-and-output"></a></h2>
<hr class="half-width"><p>The first thing to understand about IO (Input and Output) is that it
can make a big difference as to what type of a file system you are
reading from or writing to. Local disk (usually /tmp) is temporary
storage and has size restrictions, and it isn’t as fast as a parallel
file server that stripes data across many disks at the same time, but it
is still sometimes the best to use if others are heavily using the main
file server and slowing it down. As good as parallel file severs are,
they also commonly need to lock a directory if more than one file is
being written at the same time. Any locking can slow the performance of
a code down immensely and should be avoided if at all possible. Many HPC
systems may have fast scratch space which is temporary storage often
purged every week or month but very large in size. This is designed for
use when you are running your job, and may also not suffer from the same
locking issues as on some parallel file servers.</p>
<p>On our HPC system at Kansas State University, our fast scratch is
about ten times as fast as the parallel file server system that our home
directories are on. So you would think that all you have to do is use
fast scratch all the time to make your IO ten times faster. It actually
is the case if you are streaming data in, by which we mean reading in
data in large chunks that do not need to be converted. Files with large
strings like genetic information fall into this category since the
strings can be hundreds or thousands of characters long and the
representation in the file is the same as in the program. Reading in
arrays of floats or integers from binary files also can go as fast as
the file server allows since the elements are stored in binary in both
the file and the program.</p>
<p>The problem comes when we want to store numbers for example in a text
file so we can see them ourselves. When we write them or read them, the
process goes slow since we have to convert each number from its binary
representation into a text string before reading or writing. With IO, it
is that conversion process which is slow, so it doesn’t matter how fast
the underlying file server is in these cases. So if you want to speed up
IO, think about streaming data in binary form if possible, and if so
then choose the fastest file server available.</p>
<div id="scaling-study-of-the-distributed-memory-dot-product-code" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="scaling-study-of-the-distributed-memory-dot-product-code" class="callout-inner">
<h3 class="callout-title">Scaling Study of the Distributed-Memory Dot Product Code<a class="anchor" aria-label="anchor" href="#scaling-study-of-the-distributed-memory-dot-product-code"></a>
</h3>
<div class="callout-content">
<p>Measure the entire run-time for the dot_product_message_passing code
for the language you are working with for 1, 4, 8, and 16 cores if you
are on an HPC system with at least 2 compute nodes. You can try
different combinations of nodes and cores for each if you would like to
see the effects of the network (for the 4 cores, try 2 nodes 2 cores vs
4 nodes 1 core).</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>In this code we initialize the vectors locally so there is no
communication involved. The only communication is the global sum at the
end, so we expect the scaling to be close to ideal. In many practical
MPI codes, we would need to read data into one of the ranks, divide the
data up and send it out to each other node. Real MPI applications also
usually require communication mixed in with the computational part in
order to get data where it needs to be. All this communication can slow
down the job, and this usually gets worse as you spread a job over more
cores, and especially over more nodes.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>What techniques can be used to speed up scalar code?</li>
<li>How to improve input and output?</li>
<li>Learn about the difference between multi-core and multi-node
programs.</li>
<li>Understand the fundamentals of locks, barriers, and forks.</li>
<li>Practice doing a scaling study.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/performance-concepts.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/multi-threaded.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/performance-concepts.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Performance Concepts
        </a>
        <a class="chapter-link float-end" href="../instructor/multi-threaded.html" rel="next">
          Next: Multi-Threaded...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/DrDaveTurner/HPC-User/edit/main/episodes/parallel-concepts.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/DrDaveTurner/HPC-User/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/DrDaveTurner/HPC-User/" class="external-link">Source</a></p>
				<p><a href="https://github.com/DrDaveTurner/HPC-User/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:drdaveturner@gmail.com">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.5" class="external-link">sandpaper (0.16.5)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.3" class="external-link">varnish (1.0.3)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://DrDaveTurner.github.io/HPC-User/instructor/parallel-concepts.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": " HPC, software, lesson, The Carpentries, Python, C, C++, Fortran, R, Matlab",
  "name": "Parallel Computing Concepts",
  "creativeWorkStatus": "active",
  "url": "https://DrDaveTurner.github.io/HPC-User/instructor/parallel-concepts.html",
  "identifier": "https://DrDaveTurner.github.io/HPC-User/instructor/parallel-concepts.html",
  "dateCreated": "2022-01-01",
  "dateModified": "2024-08-21",
  "datePublished": "2024-08-22"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

